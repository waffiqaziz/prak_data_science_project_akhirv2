spread(sentiment, n, fill = 0) %>%
ungroup()
data9
total_category <- tidy_user_reviews %>%
inner_join(get_sentiments("bing")) %>%
count(Category, sentiment, sort = TRUE) %>%
pivot_wider(names_from = sentiment, values_from = n, values_fill = 0)
total_word <- tidy_user_reviews %>%
inner_join(get_sentiments("bing")) %>%
count(word, Category, sentiment, sort = TRUE) %>%
pivot_wider(names_from = sentiment, values_from = n, values_fill = 0)
View(total_category)
View(total_word)
analzee <- inner_join(total_word, total_category, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive/positive.y) %>%
mutate(negative_ratio = negative/negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y)
analzee
data10 <- inner_join(total_word, total_category, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive/positive.y) %>%
mutate(negative_ratio = negative/negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y)
data10
View(total_category)
bing_word_counts %>%
inner_join(get_sentiments("bing")) %>%
head(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment",
x = NULL) +
coord_flip()
bing_word_counts %>%
group_by(sentiment) %>%
slice_max(n, n = 10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment",
x = NULL) +
coord_flip()
bing_word_counts %>%
inner_join(get_sentiments("bing")) %>%
head(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment",
x = NULL) +
coord_flip()
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity", width = 1) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity", width = 2) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity") +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity", width=0.8) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
options(scipen=999)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Reviews = mean(Reviews)),
aes(x=Rata_Rata_Reviews, y=Category)) +
geom_bar(stat = "identity", width=0.7) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Reviews, y = Category, label = round(Rata_Rata_Reviews,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
ggplot(data = playStoreData %>%
group_by(Category) %>%
summarize(Rata_Rata_Rating = mean(Rating)),
aes(x=Rata_Rata_Rating, y=Category)) +
geom_bar(stat = "identity", width=0.7) +
geom_text(
# label rata-rata dibulatkan tiga angka terakhir
aes(x = Rata_Rata_Rating, y = Category, label = round(Rata_Rata_Rating,3)),
hjust = -0.07, size = 2,
position = position_dodge(width = 1),
inherit.aes = TRUE
)
data10 <- inner_join(totalWord, totalCategory, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive / positive.y) %>%
mutate(negative_ratio = negative/ negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y) %>%
arrange(word())
# jumlah categori
totalCategory <- tidy_user_reviews %>%
inner_join(get_sentiments("bing")) %>%
count(Category, sentiment, sort = TRUE) %>%
pivot_wider(names_from = sentiment, values_from = n, values_fill = 0)
# jumlah kata
totalWord <- tidy_user_reviews %>%
inner_join(get_sentiments("bing")) %>%
count(word, Category, sentiment, sort = TRUE) %>%
pivot_wider(names_from = sentiment, values_from = n, values_fill = 0)
data10 <- inner_join(totalWord, totalCategory, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive / positive.y) %>%
mutate(negative_ratio = negative/ negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y) %>%
arrange(word())
data10 <- inner_join(totalWord, totalCategory, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive / positive.y) %>%
mutate(negative_ratio = negative/ negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y) %>%
arrange(word)
data10
data10 <- inner_join(totalWord, totalCategory, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive / positive.y) %>%
mutate(negative_ratio = negative/ negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y) %>%
arrange(category)
data10 <- inner_join(totalWord, totalCategory, by="Category") %>%
rename(positive = positive.x) %>%
rename(negative = negative.x) %>%
mutate(positive_ratio = positive / positive.y) %>%
mutate(negative_ratio = negative/ negative.y) %>%
mutate(net_sentiment = positive-negative) %>%
select(-positive.y) %>%
select(-negative.y) %>%
arrange(Category)
data10
knitr::opts_chunk$set(echo = TRUE)
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
user_reviews <- vroom(here("googleplaystore_user_reviews.csv"))
googleplaystore <- vroom(here("googleplaystore.csv"))
joining_data <- user_reviews %>%
inner_join(googleplaystore)
tidy_user_reviews <- joining_data %>%
filter(Translated_Review != "nan") %>%
unnest_tokens(word, Translated_Review) %>%
anti_join(stop_words)
View(user_reviews)
View(tidy_user_reviews)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
tidy_covid19 <- df %>%
filter(Tweet != "nan") %>%
unnest_tokens(word, Tweet) %>%
anti_join(stop_words)
View(tidy_covid19)
nrc_n <-  tidy_covid19 %>%
inner_join(get_sentiments("nrc")) %>%
count(sentiment, sort = TRUE)
nrc_n
nrc_n <-  tidy_covid19 %>%
inner_join(get_sentiments("bing")) %>%
count(sentiment, sort = TRUE)
nrc_n
df[df == "0" ] <- Optimistic
df[df == "0" ] <- Optimistic```
df[df == "0" ] <- Optimistic```{r}
df[df == "0" ] <- Optimistic
df[df == "0" ] <- "Optimistic"
df[df == "1" ] <- "Thankful"
df[df == "2" ] <- "Empathetic"
df[df == "3" ] <- "Pessimistic"
df[df == "4" ] <- "Anxious"
df[df == "5" ] <- "Sad"
df[df == "6" ] <- "Annoyed"
df[df == "7" ] <- "Denial"
df[df == "8" ] <- "Surprise"
df[df == "9" ] <- "Official_report"
df[df == "10" ] <- "Joking"
``
df[df == "0" ] <- "Optimistic"
df[df == "1" ] <- "Thankful"
df[df == "2" ] <- "Empathetic"
df[df == "3" ] <- "Pessimistic"
df[df == "4" ] <- "Anxious"
df[df == "5" ] <- "Sad"
df[df == "6" ] <- "Annoyed"
df[df == "7" ] <- "Denial"
df[df == "8" ] <- "Surprise"
df[df == "9" ] <- "Official_report"
df[df == "10" ] <- "Joking"
View(df)
df$Labels <- sub("0", "Thankful", df$Labels)
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
df$Labels <- sub("0", "Thankful", df$Labels)
View(df)
df$Labels <- sub("0", " Thankful", df$Labels)
View(df)
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
df$Labels <- sub(" 0 ", " Thankful ", df$Labels)
View(df)
df$Labels <- sub(" 0 ", " Thankful ", df$Labels)
df$Labels[1,1]
df$Labels <- sub(" 0 ", " Thankful ", df$Labels)
df$Labels[1,1,1]
df$Labels <- sub(" 0 ", " Thankful ", df$Labels)
df$Labels
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
df$Labels <- sub("0 ", " Thankful ", df$Labels)
df$Labels
View(df)
df$Labels <- sub("0 ", "Thankful ", df$Labels)
df$Labels <- sub("0 ", "Thankful ", df$Labels)df$Labels
df$Labels <- sub("0 ", "Thankful ", df$Labels)
df$Labels <- sub("0 ", "Thankful ", df$Labels)
df$Labels <- sub(" 7", "Thankful ", df$Labels)
df$Labels <- sub(" 7", "Thankful ", df$Labels)df$Labels
df$Labels <- sub(" 7", "Thankful ", df$Labels)
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
df$Labels <- sub("0 ", "Optimistic ", df$Labels)
df$Labels <- sub(" 0 ", " Optimistic ", df$Labels)
df$Labels <- sub(" 0", " Optimistic ", df$Labels)
df$Labels <- sub("1 ", "Thankful ", df$Labels)
df$Labels <- sub(" 1 ", "Thankful ", df$Labels)
df$Labels <- sub(" 1", " Thankful ", df$Labels)
df$Labels <- sub("2 ", "Empathetic ", df$Labels)
df$Labels <- sub(" 2 ", " Empathetic ", df$Labels)
df$Labels <- sub(" 2", " ", df$Labels)
df$Labels <- sub("3 ", "Pessimistic ", df$Labels)
df$Labels <- sub(" 3 ", " Pessimistic ", df$Labels)
df$Labels <- sub(" 3", " Pessimistic", df$Labels)
df$Labels <- sub("4 ", "Anxious ", df$Labels)
df$Labels <- sub(" 4 ", " Anxious ", df$Labels)
df$Labels <- sub(" 4", " Anxious", df$Labels)
df$Labels <- sub("5 ", "Sad ", df$Labels)
df$Labels <- sub(" 5 ", " Sad ", df$Labels)
df$Labels <- sub(" 5", " Sad", df$Labels)
df$Labels <- sub("6 ", "Annoyed ", df$Labels)
df$Labels <- sub(" 6 ", " Annoyed ", df$Labels)
df$Labels <- sub(" 6", " Annoyed", df$Labels)
df$Labels <- sub("7 ", "Denial ", df$Labels)
df$Labels <- sub(" 7 ", " Denial ", df$Labels)
df$Labels <- sub(" 7", " Denial", df$Labels)
df$Labels <- sub("8 ", "Surprise ", df$Labels)
df$Labels <- sub(" 8 ", " Surprise ", df$Labels)
df$Labels <- sub(" 8", " Surprise", df$Labels)
df$Labels <- sub("9", "Official_report ", df$Labels)
df$Labels <- sub(" 9 ", " Official_report", df$Labels)
df$Labels <- sub(" 9", " Official_report ", df$Labels)
df$Labels <- sub("10", "Joking ", df$Labels)
df$Labels <- sub(" 10", " Joking", df$Labels)
df$Labels
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(vroom)
library(here)
library(tidytext)
df <- read.csv("training.csv")
df$Labels <- sub("0", "Optimistic ", df$Labels)
df$Labels <- sub("0 ", "Optimistic ", df$Labels)
df$Labels <- sub(" 0 ", " Optimistic ", df$Labels)
df$Labels <- sub(" 0", " Optimistic ", df$Labels)
df$Labels <- sub("1", "Thankful ", df$Labels)
df$Labels <- sub("1 ", "Thankful ", df$Labels)
df$Labels <- sub(" 1 ", "Thankful ", df$Labels)
df$Labels <- sub(" 1", " Thankful ", df$Labels)
df$Labels <- sub("2", "Empathetic ", df$Labels)
df$Labels <- sub("2 ", "Empathetic ", df$Labels)
df$Labels <- sub(" 2 ", " Empathetic ", df$Labels)
df$Labels <- sub(" 2", " ", df$Labels)
df$Labels <- sub("3", "Pessimistic ", df$Labels)
df$Labels <- sub("3 ", "Pessimistic ", df$Labels)
df$Labels <- sub(" 3 ", " Pessimistic ", df$Labels)
df$Labels <- sub(" 3", " Pessimistic", df$Labels)
df$Labels <- sub("4", "Anxious ", df$Labels)
df$Labels <- sub("4 ", "Anxious ", df$Labels)
df$Labels <- sub(" 4 ", " Anxious ", df$Labels)
df$Labels <- sub(" 4", " Anxious", df$Labels)
df$Labels <- sub("5", "Sad ", df$Labels)
df$Labels <- sub("5 ", "Sad ", df$Labels)
df$Labels <- sub(" 5 ", " Sad ", df$Labels)
df$Labels <- sub(" 5", " Sad", df$Labels)
df$Labels <- sub("6", "Annoyed ", df$Labels)
df$Labels <- sub("6 ", "Annoyed ", df$Labels)
df$Labels <- sub(" 6 ", " Annoyed ", df$Labels)
df$Labels <- sub(" 6", " Annoyed", df$Labels)
df$Labels <- sub("7", "Denial ", df$Labels)
df$Labels <- sub("7 ", "Denial ", df$Labels)
df$Labels <- sub(" 7 ", " Denial ", df$Labels)
df$Labels <- sub(" 7", " Denial", df$Labels)
df$Labels <- sub("8", "Surprise ", df$Labels)
df$Labels <- sub("8 ", "Surprise ", df$Labels)
df$Labels <- sub(" 8 ", " Surprise ", df$Labels)
df$Labels <- sub(" 8", " Surprise", df$Labels)
df$Labels <- sub("9", "Official_report ", df$Labels)
df$Labels <- sub("9 ", "Official_report ", df$Labels)
df$Labels <- sub(" 9 ", " Official_report", df$Labels)
df$Labels <- sub(" 9", " Official_report ", df$Labels)
df$Labels <- sub("10", "Joking ", df$Labels)
df$Labels <- sub(" 10", " Joking", df$Labels)
tidy_covid19 <- df %>%
filter(Tweet != "nan") %>%
unnest_tokens(word, Tweet) %>%
anti_join(stop_words)
nrc_n <-  tidy_covid19 %>%
inner_join(get_sentiments("bing")) %>%
count(sentiment, sort = TRUE)
nrc_n
nrc_n <-  tidy_covid19 %>%
inner_join(get_sentiments("nrc")) %>%
count(sentiment, sort = TRUE)
nrc_n
user_reviews_nrc <- tidy_user_reviews %>%
inner_join(get_sentiments("nrc")) %>%
group_by(Label) %>%
count(sentiment, sort = TRUE) %>%
spread(sentiment, n, fill = 0) %>%
ungroup()
covid_nrc <- tidy_user_reviews %>%
inner_join(get_sentiments("nrc")) %>%
group_by(Labels) %>%
count(sentiment, sort = TRUE) %>%
spread(sentiment, n, fill = 0) %>%
ungroup()
covid_nrc <- tidy_covid19 %>%
inner_join(get_sentiments("nrc")) %>%
group_by(Labels) %>%
count(sentiment, sort = TRUE) %>%
spread(sentiment, n, fill = 0) %>%
ungroup()
covid_nrc
knitr::opts_chunk$set(echo = TRUE)
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
source("~/.active-rstudio-document", echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(rstudioapi::getSourceEditorContext()$path)) # auto set directory
library(tidymodels)
library(tidytext)
library(dplyr)
df <- read.csv("Coronavirus_Tweets.csv")
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- as.Date(df$TweetAt , format = "%d/%m/%y")
# df = na.omit(df)
df %>%
group_by(Sentiment) %>%
tally() %>%
ggplot(aes(x=Sentiment, y=n, fill = Sentiment)) +
theme(axis.text.x = element_text(angle = 45)) +
geom_col()
df %>%
filter(Sentiment == "Extremely Positive")
df %>%
group_by(TweetAt) %>%
tally() %>%
ggplot(aes(x=TweetAt, y=n)) +
theme(axis.text.x = element_text(angle = 90)) +
scale_x_date(breaks = df$TweetAt) +
geom_bar(stat = "identity")
library(dplyr) # Data wrangling & manipulation
library(tidytext) # For unnest_tokens
library(stringr) # For managing text
library(ggplot2) # For data visualizations & graphs
text <- c(df$Location)
text <- paste(text, collapse = " ")
text <- str_replace_all(text, pattern = '\"', replacement = "") # Remove slashes
text <- str_replace_all(text, pattern = '\n', replacement = "") # Remove \n
text <- str_replace_all(text, pattern = '\u0092', replacement = "'") #Replace with quote
text <- str_replace_all(text, pattern = '\u0091', replacement = "'") #Replace with quote
text_df <- data_frame(Text = text) # tibble aka neater data frame
text_words <- text_df %>%
unnest_tokens(output = word, input = Text)
# data(stop_words) # Stop words.
text_words  <- text_words  %>%
anti_join(stop_words) # Remove stop words in peter_words
# Word Counts:
text_wordcounts <- text_words  %>% count(word, sort = TRUE)
head(text_wordcounts)
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
# df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=''),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=''),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df <- read.csv("Coronavirus_Tweets.csv")
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- as.Date(df$TweetAt , format = "%d/%m/%y")
# df = na.omit(df)
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=')'),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=')'),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split='.'),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df <- read.csv("Coronavirus_Tweets.csv")
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- sub("-", "/", df$TweetAt)
df$TweetAt <- as.Date(df$TweetAt , format = "%d/%m/%y")
# df = na.omit(df)
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=' '),function(s) paste(s[!grepl('^https:',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$OriginalTweet),split=' '),function(s) paste(s[!grepl('^@',s)],collapse=' '))
df$Tweets <- sapply(strsplit(as.character(df$Tweets),split=' '),function(s) paste(s[!grepl('^https:',s)],collapse=' '))
View(df)
